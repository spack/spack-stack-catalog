spack:
  view: false
  concretization: separately
  config:
    build_stage: $spack/var/spack/stage
    misc_cache: $spack/var/spack/misc_cache
    concretizer: clingo

  compilers:
  - compiler:
      spec: gcc@7.5.0
      paths:
        cc: /usr/bin/gcc
        cxx: /usr/bin/g++
        f77: /usr/bin/gfortran
        fc: /usr/bin/gfortran
      flags: {}
      operating_system: sles15
      target: any
      modules: []
  - compiler:
      spec: nvhpc@22.02
      paths:
        cc: /opt/cray/pe/craype/default/bin/cc
        cxx: /opt/cray/pe/craype/default/bin/CC
        f77: /opt/cray/pe/craype/default/bin/ftn
        fc: /opt/cray/pe/craype/default/bin/ftn
      flags: {}
      operating_system: sles15
      target: any
      modules:
      - PrgEnv-nvidia
      - nvidia/22.2
      - craype-x86-milan
      - libfabric
  - compiler:
      spec: gcc@11.2.0
      paths:
        cc: cc
        cxx: CC
        f77: ftn
        fc: ftn
      flags: {}
      operating_system: sles15
      target: any
      modules:
      - PrgEnv-gnu
      - gcc/11.2.0
      - craype-x86-milan
      - libfabric
      extra_rpaths: []

  - compiler:
      spec: cce@13.0.2
      paths:
        cc: /opt/cray/pe/craype/default/bin/cc
        cxx: /opt/cray/pe/craype/default/bin/CC
        f77: /opt/cray/pe/craype/default/bin/ftn
        fc: /opt/cray/pe/craype/default/bin/ftn
      flags: {}
      operating_system: sles15
      target: any
      modules:
      - PrgEnv-cray
      - cce/13.0.2
      - craype-x86-milan
      - libfabric
      environment: {}
      extra_rpaths: []
  
  packages:
    all:
      compiler: [gcc@11.2.0, nvhpc@22.02, cce@13.0.2]
      providers:
        blas: [cray-libsci]
        mpi: [cray-mpich]
    amrex:
      variants: +fortran +hypre +openmp +petsc +shared
    binutils:
      variants: +ld +gold +headers +libiberty ~nls
    bzip2:
      version: [1.0.6]
      externals:
      - spec: bzip2@1.0.6
        prefix: /usr
    cray-libsci:
      buildable: false
      externals:
      - spec: cray-libsci@21.08.1.2
        modules:
        - cray-libsci/21.08.1.2
    cray-mpich:
      buildable: false
      externals:
      - spec: cray-mpich@8.1.13 %gcc@11.2.0
        prefix: /opt/cray/pe/mpich/8.1.13/ofi/gnu/9.1
        modules:
        - cray-mpich/8.1.13
        - cudatoolkit/11.5
      - spec: cray-mpich@8.1.13 %nvhpc@22.02
        prefix: /opt/cray/pe/mpich/8.1.13/ofi/nvidia/20.7
        modules:
        - cray-mpich/8.1.13
        - cudatoolkit/11.5
      - spec: cray-mpich@8.1.13 %cce@13.0.2
        prefix: /opt/cray/pe/mpich/8.1.13/ofi/cray/10.0/
        modules:
        - cray-mpich/8.1.13
        - cudatoolkit/11.5
    cuda:
      buildable: false
      version: [11.5.0]
      externals:
      - spec: cuda@11.5.0
        prefix: /opt/nvidia/hpc_sdk/Linux_x86_64/21.11/cuda/11.5
        modules:
        - cudatoolkit/11.5
    cub:
      buildable: false
      externals:
      - spec: cub@1.13.1
        prefix: /opt/nvidia/hpc_sdk/Linux_x86_64/21.11/math_libs/11.5
        modules:
        - cudatoolkit/11.5
    curl:
      buildable: false
      externals:
      - spec: curl@7.66.0
        prefix: /usr
    diffutils:
      version: [3.6]
      externals:
      - spec: diffutils@3.6
        prefix: /usr        
    elfutils:
      variants: +bzip2 ~nls +xz        
    findutils:
      version: [4.6.0]
      externals:
      - spec: findutils@4.6.0
        prefix: /usr
    hdf5:
      variants: +fortran +hl +shared api=v18
      version: [1.12.1]
    hypre:
      variants: +openmp +superlu-dist
    gcc:
      buildable: false
      externals:
      - spec: gcc@11.2.0 %gcc@7.5.0
        modules:
        - PrgEnv-gnu
        - gcc/11.2.0
        - craype-x86-milan
        - libfabric
    git:
      version: [2.26.2]
      buildable: false
      externals:
      - spec: git@2.26.2
        prefix: /usr
    libfabric:
      buildable: false
      variants: fabrics=sockets,tcp,udp,rxm
      externals:
      - spec: libfabric@1.11.0.4.114
        prefix: /opt/cray/libfabric/1.11.0.4.114
        modules:
        - libfabric/1.11.0.4.114
    libunwind:
      variants: +pic +xz
    mercury:
      variants: ~bmi
    mesa:
      variants: ~llvm
    mesa18:
      variants: ~llvm
    m4:
      buildable: false
      externals:
      - spec: m4@1.4.18
        prefix: /usr
    mpich:
      variants: ~wrapperrpath
    ncurses:
      variants: +termlib
      externals:
      - spec: ncurses@6.1
        prefix: /usr
    nvhpc:
      buildable: false
      externals:
      - spec: nvhpc@22.02 %gcc@7.5.0
        modules:
        - PrgEnv-nvidia
        - nvidia/22.02
        - craype-x86-milan
        - libfabric
    openssl:
      version: [1.1.0i]
      buildable: false
      externals:
      - spec: openssl@1.1.0i
        prefix: /usr
    openssh:
      version: [7.9p1]
      buildable: false
      externals:
      - spec: openssh@7.9p1
        prefix: /usr
    petsc:
      variants: +openmp +strumpack
    pdsh:
      buildable: false
      externals:
      - spec: pdsh@2.34
        prefix: /usr    
    python:
      version: [3.8.13]
    readline:
      version: [7.0]
      buildable: false
      externals:
      - spec: readline@7.0
        prefix: /usr
    slurm:
      buildable: false
      version: [20-11-8-1]
      externals:
      - spec: slurm@20-11-8-1
        prefix: /usr
    superlu-dist:
      variants: +openmp
    strumpack:
      variants: ~slate
    tar:
      version: [1.3]
      buildable: false
      externals:
      - spec: tar@1.30
        prefix: /usr
    trilinos:
      variants: +amesos +amesos2 +anasazi +aztec +belos +boost +epetra +epetraext
        +ifpack +ifpack2 +intrepid +intrepid2 +isorropia +kokkos +ml +minitensor +muelu
        +nox +piro +phalanx +rol +rythmos +sacado +stk +shards +shylu +stokhos +stratimikos
        +teko +tempus +tpetra +trilinoscouplings +zoltan +zoltan2 +superlu-dist gotype=long_long
    unzip:
      version: [6.0]
      buildable: false
      externals:
      - spec: unzip@6.0
        prefix: /usr
    util-linux-uuid:
      version: [2.33.1]
      buildable: false
      externals:
      - spec: util-linux-uuid@2.33.1
        prefix: /usr
    xz:
      version: [5.2.3]
      buildable: false
      externals:
      - spec: xz@5.2.3
        prefix: /usr
    zsh:
      version: [5.6]
      buildable: false
      externals:
      - spec: zsh@5.6
        prefix: /usr

  definitions:
  - gcc_compilers: ['%gcc@11.2.0']
  - nvhpc_compilers: ['%nvhpc@22.02']  
  - cce_compilers: ['%cce@13.0.2']  
  - compilers: [gcc@11.2.0 %gcc@7.5.0, nvhpc@22.02 %gcc@7.5.0, cce@13.0.2 %gcc@7.5.0]

  - gcc_specs:  
    - adios2@2.8.0
    - aml@0.1.0
    - amrex@22.05
    - arborx@1.2
    - argobots@1.1
    - ascent@0.8.0
    - axom@0.6.1
    - bolt@2.0
    - butterflypack@2.1.1
    - cabana@0.4.0
    - caliper@2.7.0
    - chai@2.4.0 ~benchmarks ~tests
    - conduit@0.8.3
    - darshan-runtime@3.3.1
    - darshan-util@3.3.1
    - datatransferkit@3.1-rc3
    - dyninst@12.1.0
    - faodel@1.2108.1
    - flecsi@1.4.2
    - flit@2.1.0
    - fortrilinos@2.0.0
    - gasnet@2022.3.0
    - geopm@1.1.0
    - ginkgo@1.4.0
    - globalarrays@5.8
    - gotcha@1.0.3
    - gptune@3.0.0
    - h5bench@1.2
    - hdf5@1.10.7 +fortran +hl +shared
    - heffte@2.2.0 +fftw
    - hpctoolkit@2022.04.15
    - hpx@1.7.1 networking=mpi
    - hypre@2.24.0
    - kokkos@3.6.00 +openmp
    - kokkos-kernels@3.6.00 +openmp
    - lammps@20220107
    - legion@21.03.0
    - libnrm@0.1.0
    - libquo@1.3.1
    - libunwind@1.6.2
    - loki@0.1.7
    - mercury@2.1.0
    - metall@0.20
    - mfem@4.4.0
    - mpark-variant@1.4.0
    - mpifileutils@0.11.1 ~xattr
    - nccmp@1.9.0.1
    - nco@5.0.1
    - nrm@0.1.0
    - omega-h@9.34.1
    - openpmd-api@0.14.4
    - papi@6.0.0.1
    - papyrus@1.0.2
    - parallel-netcdf@1.12.2
    - paraview@5.10.1 +qt
    - parsec@3.0.2012 ~cuda
    - pdt@3.25.1
    - petsc@3.17.1
    - phist@1.9.5
    - plasma@21.8.29
    - plumed@2.6.3
    - precice@2.4.0
    - pruners-ninja@1.0.1
    - pumi@2.2.7  
    - py-warpx@22.05 ^warpx dims=2
    - py-warpx@22.05 ^warpx dims=3
    - py-warpx@22.05 ^warpx dims=rz
    - qthreads@1.16 scheduler=distrib
    - raja@0.14.0
    - rempi@1.1.0
    - scr@3.0rc2
    - slate@2021.05.02 ~cuda
    - slepc@3.17.1
    - stc@0.9.0
    - strumpack@6.3.1 ~slate
    - sundials@6.2.0
    - superlu@5.3.0
    - superlu-dist@7.2.0
    - swig@4.0.2
    - swig@4.0.2-fortran
    - sz@2.1.12
    - tasmanian@7.7
    - tau@2.31 +mpi +python
    - trilinos@13.0.1 +amesos +amesos2 +anasazi +aztec +belos +boost +epetra +epetraext +ifpack
      +ifpack2 +intrepid +intrepid2 +isorropia +kokkos +ml +minitensor +muelu +nox +piro
      +phalanx +rol +rythmos +sacado +stk +shards +shylu +stokhos +stratimikos +teko
      +tempus +tpetra +trilinoscouplings +zoltan +zoltan2 +superlu-dist gotype=long_long
    - turbine@1.3.0
    - umap@2.1.0
    - umpire@6.0.0
    - unifyfs@0.9.2
    - upcxx@2022.3.0
    - variorum@0.4.1
    - veloc@1.5
    - vtk-m@1.7.1
    - wannier90@3.1.0
    - zfp@0.5.5

  - nvhpc_specs:
    - zfp@0.5.5
  
  - cce_specs:
    - zfp@0.5.5
  
  - cuda_specs:
    # GPU
    - adios2@2.8.0 +cuda cuda_arch=80
    - arborx@1.2 +cuda cuda_arch=80 ^kokkos@3.6.00 +wrapper
    - cabana@0.4.0 +cuda ^kokkos@3.6.00 +wrapper +cuda_lambda +cuda cuda_arch=80
    - caliper@2.7.0 +cuda cuda_arch=80
    - chai@2.4.0 ~benchmarks ~tests +cuda cuda_arch=80 ^umpire@6.0.0 ~shared
    - ginkgo@1.4.0 +cuda cuda_arch=80
    - heffte@2.2.0 +cuda cuda_arch=80
    - hpctoolkit@2022.04.15 +cuda
    - hpx@1.7.1 +cuda cuda_arch=80
    - hypre@2.24.0 +cuda cuda_arch=80
    - kokkos@3.6.00 +wrapper +cuda cuda_arch=80
    - kokkos-kernels@3.6.00 +cuda cuda_arch=80 ^kokkos@3.6.00 +wrapper +cuda cuda_arch=80
    - magma@2.6.2 +cuda cuda_arch=80
    - mfem@4.4.0 +cuda cuda_arch=80
    - papi@6.0.0.1 +cuda
    - parsec@3.0.2012 +cuda cuda_arch=80
    - petsc@3.17.1+cuda cuda_arch=80
    - raja@0.14.0 +cuda cuda_arch=80
    - slate@2021.05.02 +cuda cuda_arch=80
    - slepc@3.17.1 +cuda cuda_arch=80
    - strumpack@6.3.1 ~slate +cuda cuda_arch=80
    - sundials@6.2.0 +cuda cuda_arch=80
    - superlu-dist@7.2.0 +cuda cuda_arch=80
    - tasmanian@7.7 +cuda cuda_arch=80
    - tau@2.31.1 +mpi +cuda ^mpich@4.0.2
    - trilinos@13.2.0 +cuda cuda_arch=80
    - umpire@6.0.0 ~shared +cuda cuda_arch=80
    - vtk-m@1.7.1 +cuda cuda_arch=80
    - zfp@0.5.5 +cuda cuda_arch=80
  specs:
  - matrix:
    - [$gcc_specs]
    - [$gcc_compilers]
  - matrix:
    - [$cuda_specs]
    - [$gcc_compilers]
  - matrix:
    - [$nvhpc_specs]
    - [$nvhpc_compilers]
  - matrix:
    - [$cce_specs]
    - [$cce_compilers]
  - $compilers
